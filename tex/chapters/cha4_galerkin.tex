%!TEX root = ../main.tex

\chapter{Petrov"=Galerkin"=Verfahren} % (fold)
\label{chapter:galerkin}

In diesem Kapitel führen wir das sogenannte Petrov"=Galerkin"=Verfahren ein, welches als Grundlage für die Reduzierte-Basis-Methoden des nächsten Kapitels dienen wird, und betrachten erste numerische Experimente.
Dies werden wir, wie auch bereits bei den funktionalanalytischen Grundlagen in \cref{chapter:grundlagen}, zunächst möglichst allgemein halten.
Als Quelle dienen vor allem die Arbeiten von \textcite{Braess:2007wm,Patera:2007un,Quarteroni:2011jm}, weitere werden an den entsprechenden Stellen angegeben.

Die Rahmenbedingungen für die nachfolgenden Ausführungen seien wie folgt:
Seien $\mathcal X$ und $\mathcal Y$ zwei Hilberträume und sei weiter $b \colon \mathcal X \times \mathcal Y \to \mathbb{R}$ eine stetige Bilinearform und $f \colon \mathcal Y \to \mathbb{R}$ ein stetiges lineares Funktional.
Wir betrachten das abstrakte Variationsproblem
\begin{equation}
    \label{eq:abstraktes_variationsproblem_galerkin}
    \text{Finde}~u \in \mathcal X \colon \quad  b(u, v) = f(v) \quad \fa v \in \mathcal Y.
\end{equation}
Unter welchen Bedingungen dieses Variationsproblem lösbar ist, haben wir bereits in \cref{chapter:grundlagen} diskutiert.
Für den Rest dieses Kapitels nehmen wir an, dass \cref{eq:abstraktes_variationsproblem_galerkin} korrekt gestellt ist und insbesondere die inf-sup-Konstante $\beta$ die Bedingung
\begin{equation}
    \label{eq:abstraktes_variationsproblem_galerkin_infsup}
    \beta := \inf_{u \in \mathcal X} \sup_{v \in \mathcal Y} \frac{b(u, v)}{\norm{u}_{\mathcal X} \norm{v}_{\mathcal Y}} > 0
\end{equation}
erfüllt.

\section{Grundlagen des Petrov"=Galerkin"=Verfahrens} % (fold)
\label{section:petrov_galerkin_grundlagen}

Die \emph{Petrov-Galerkin-Verfahren} stelle eine Unterklasse der Galerkin-Verfahren dar und werden als Bezeichnung für Verfahren, die auf Variationsprobleme, bei denen Ansatz- und Testfunktionenraum nicht identisch sind, zugeschnitten sind, verwendet.

Die grundlegende Idee hinter Galerkin-Verfahren ist die Diskretisierung des Variationsproblems \cref{eq:abstraktes_variationsproblem_galerkin} durch Approximation der im Allgemeinen unendlichdimensionalen Hilberträume $\mathcal X$ und $\mathcal Y$ mittels endlichdimensionaler Unterräume $\mathcal X_{\mathcal N} \subset \mathcal X$ und $\mathcal Y_{\mathcal M} \subset \mathcal Y$.
Wir beschränken uns hier auf den Fall $\mathcal N = \mathcal M$.
Zwar ist auch für den Fall $\mathcal M > \mathcal N$ eine sinnvolle Anwendung des Galerkin-Verfahrens möglich, allerdings erfolgt diese dann im Sinne einer Residuums-Minimierung, vergleiche \cite{Andreev:2012ep}, und verträgt sich deswegen nicht mit der Anwendung der Reduzierte-Basis-Methoden in \cref{chapter:rbm}.

Wir halten uns hauptsächlich an die Ausführungen von \textcite[Section 3.1]{Nochetto:2009il} und beginnen, indem wir den Begriff der Petrov"=Galerkin"=Lösung definieren.

\begin{Definition}
    \label{definition:disrekte_loesung}
    Seien durch $\mathcal X_{\mathcal N} \subset \mathcal X$ und $\mathcal Y_{\mathcal N} \subset \mathcal Y$ Unterräume der Dimension $\mathcal N \in \mathbb{N}$ gegeben.
    Als \emph{Petrov"=Galerkin"=Lösung} von \cref{eq:abstraktes_variationsproblem_galerkin} bezeichnen wir eine Lösung $u_{\mathcal N} \in \mathcal X_{\mathcal N}$ des Variationsproblems:
    \begin{equation}
        \label{eq:diskretes_variationsproblem}
        \text{Finde}~u_{\mathcal N} \in \mathcal X_{\mathcal N} \colon \quad  b(u_{\mathcal N}, v) = f(v) \quad \fa v \in \mathcal Y_{\mathcal N}.
    \end{equation}
\end{Definition}

Zur einfacheren Unterscheidung bezeichnen wir \cref{eq:abstraktes_variationsproblem_galerkin} im Weiteren als stetiges und \cref{eq:diskretes_variationsproblem} als diskretes Variationsproblem.

\begin{Bemerkung}
    \label{bemerkung:zur_wohldefiniertheit}
    Anders als bei den bekannten Galerkin"=Verfahren für elliptische Probleme führt eine solche Diskretisierung eines korrekt gestellten Problems nicht automatisch zu einem korrekt gestellten diskreten Problem.
    Dies wird deutlich durch
    \begin{equation}
        \sup_{v \in \mathcal Y} \frac{b(u, v)}{\norm{v}_{\mathcal Y}} \geq \sup_{v \in \mathcal Y_{\mathcal N}} \frac{b(u, v)}{\norm{v}_{\mathcal Y}} \quad \fa u \in \mathcal X.
    \end{equation}
    Dadurch ist, selbst wenn die stetige inf-sup-Bedingung \cref{eq:abstraktes_variationsproblem_galerkin_infsup} gilt, nicht sichergestellt, dass die diskrete inf-sup-Konstante $\beta_{\mathcal N}$ von \cref{eq:diskretes_variationsproblem} die entsprechende Bedingung
    \begin{equation}
        \label{eq:diskrete_inf_sup_kosntante}
        \beta_{\mathcal N} := \inf_{u \in \mathcal X_{\mathcal N}} \sup_{v \in \mathcal Y_{\mathcal N}} \frac{b(u, v)}{\norm{u}_{\mathcal X} \norm{v}_{\mathcal Y}} = \inf_{v \in \mathcal Y_{\mathcal N}} \sup_{u \in \mathcal X_{\mathcal N}} \frac{b(u, v)}{\norm{u}_{\mathcal X} \norm{v}_{\mathcal Y}} > 0
    \end{equation}
    erfüllt.
   Anders als im stetigen Fall, gilt aufgrund der endlichen Dimension von $\mathcal X_{\mathcal N}$ und $\mathcal Y_{\mathcal N}$ stets die Gleichheit der beiden inf"=sup"=Konstanten in \cref{eq:diskrete_inf_sup_kosntante}.

   Lediglich die Stetigkeit muss nicht explizit nachgewiesen werden, da die diskrete Stetigkeitskonstante $\gamma_{\mathcal N}$ stets durch die des stetigen Variationsproblems von oben beschränkt wird.
\end{Bemerkung}

Der folgende Satz fasst einige äquivalente Bedingungen zusammen, welche sicherstellen, dass das resultierende diskrete Variationsproblem \cref{eq:diskretes_variationsproblem} korrekt gestellt ist.

\begin{Satz}
\label{satz:galerkin_wohldefiniertheit}
    Seien $\mathcal X_{\mathcal N}$ und $\mathcal Y_{\mathcal N}$ Unterräume von $\mathcal X$ respektive $\mathcal Y$ mit Dimension $\mathcal N$ und sei weiter $f \in \mathcal Y_{\mathcal N}'$.
    Dann besitzt das diskrete Variationsproblem \cref{eq:diskretes_variationsproblem} genau dann eine eindeutige Lösung $u_{\mathcal N} \in \mathcal X_{\mathcal N}$, wenn eine der folgenden äquivalenten Bedingungen erfüllt ist:
    \begin{thmenumerate}
        \item \label{punkt:gal:tfae_diskrete_inf_sup} Es gilt die diskrete inf-sup-Bedingung \cref{eq:diskrete_inf_sup_kosntante}.
        \item \label{punkt:gal:tfae_infsup_x} Es gilt
            \begin{equation}
                \inf_{u \in \mathcal X_{\mathcal N}} \sup_{v \in \mathcal Y_{\mathcal N}} \frac{b(u, v)}{\norm{u}_{\mathcal X} \norm{v}_{\mathcal Y}} > 0.
            \end{equation}
        \item \label{punkt:gal:tfae_infsup_y} Es gilt
            \begin{equation}
                \inf_{v \in \mathcal Y_{\mathcal N}} \sup_{u \in \mathcal X_{\mathcal N}} \frac{b(u, v)}{\norm{u}_{\mathcal X} \norm{v}_{\mathcal Y}} > 0.
            \end{equation}
        \item \label{punkt:gal:tfae_injektiv1} Für jedes $0 \neq u \in \mathcal X_{\mathcal N}$ existiert ein $v \in \mathcal Y_{\mathcal N}$ mit $b(u, v) \neq 0$.
        \item \label{punkt:gal:tfae_injektiv2} Für jedes $0 \neq v \in \mathcal Y_{\mathcal N}$ existiert ein $u \in \mathcal X_{\mathcal N}$ mit $b(u, v) \neq 0$.
    \end{thmenumerate}

    \begin{Beweis}
        Siehe \cite[Theorem 3.1, Proposition 3.1]{Nochetto:2009il}.
    \end{Beweis}
\end{Satz}

Obwohl die Bedingungen \cref{punkt:gal:tfae_infsup_x,punkt:gal:tfae_infsup_y,punkt:gal:tfae_injektiv1,punkt:gal:tfae_injektiv2} augenscheinlich angenehmer zu Handhaben sind, hat Bedingung \cref{punkt:gal:tfae_diskrete_inf_sup} eine besondere Bedeutung, da die diskrete inf"=sup"=Konstante wichtiger Bestandteil der nachfolgenden Stabilitätsaussage ist.

\begin{Satz}
    \label{satz:galerkin_stabilitaet}
    Gilt die diskrete inf-sup-Bedingung \cref{eq:diskrete_inf_sup_kosntante}, dann erfüllt die Petrov"=Galerkin"=Lösung $u_{\mathcal N} \in \mathcal X_{\mathcal N}$ die Abschätzung
    \begin{equation}
        \label{eq:galerkin_statibilitaet}
        \norm{u_{\mathcal N}}_{\mathcal X} \leq \frac{1}{\beta_{\mathcal N}} \norm{f}_{\mathcal Y'}.
    \end{equation}

    \begin{Beweis}
        Direkte Folgerung aus dem \acl{bnb}, \cref{satz:bnb_theorem}.
    \end{Beweis}
\end{Satz}

Eine weitere, äußerst nützliche Eigenschaft der Galerkin"=Verfahren ist die sogenannte Galerkin"=Orthogonalität, welche zusammen mit obiger Stabilitätsaussage zu einer Fehlerabschätzung verarbeitet werden kann.

\begin{Lemma}[Galerkin-Orthogonalität]
    \label{lemma:galerkin_orthogonalitaet}
    Sei $u \in \mathcal X$ die Lösung des stetigen Variationsproblems \cref{eq:abstraktes_variationsproblem_galerkin} und sei $u_{\mathcal N} \in \mathcal X_{\mathcal N}$ die Lösung eines zugehörigen diskreten Variationsproblems \cref{eq:diskretes_variationsproblem}.
    Dann gilt
    \begin{equation}
        \label{eq:galerkin_orthogonalitaet}
        b(u - u_{\mathcal N}, v) = 0 \quad \fa v \in \mathcal Y_{\mathcal N},
    \end{equation}
    das heißt, der Fehler $u - u_{\mathcal N}$ ist orthogonal zu $\mathcal Y_{\mathcal N}$.

    \begin{Beweis}
        Ausnutzen der Bilinearität von $b$ liefert für beliebiges $v \in \mathcal Y_{\mathcal N}$ die Gleichung
        \begin{equation}
            b(u - u_{\mathcal N}, v) = b(u, v) - b(u_{\mathcal N}, v) = f(v) - f(v) = 0,
        \end{equation}
        wobei die zweite Gleichheit durch $\mathcal Y_{\mathcal N} \subset \mathcal Y$ gerechtfertigt ist.
    \end{Beweis}
\end{Lemma}

\begin{Satz}[Lemma von Céa]
    \label{satz:lemma_von_cea}
    Sei $u \in \mathcal X$ die Lösung des stetigen Variationsproblems \cref{eq:abstraktes_variationsproblem_galerkin} und $u_{\mathcal N} \in \mathcal X_{\mathcal N}$ die diskrete Lösung von \cref{eq:diskretes_variationsproblem}.
    Sei weiter $\gamma$ die Stetigkeitskonstante des stetigen Variationsproblems.
    Der Fehler $u - u_{\mathcal N}$ erfüllt die Ungleichung
    \begin{equation}
        \label{eq:lemma_von_cea}
        \norm{u - u_{\mathcal N}}_{\mathcal X} \leq \frac{\gamma}{\beta_{\mathcal N}} \inf_{w \in \mathcal X_{\mathcal N}} \norm{u - w}_{\mathcal X}.
    \end{equation}

    \begin{Beweis}
        Siehe \cite[Theorem 3.2]{Nochetto:2009il}.
    \end{Beweis}
\end{Satz}

Anhand von \cref{satz:galerkin_stabilitaet} und \cref{satz:lemma_von_cea} wird die Wichtigkeit der diskreten inf-sup-Konstante $\beta_{\mathcal N}$ deutlich.
Insbesondere motiviert dies die abschließende Forderung der folgenden Stabilitätseigenschaft für die diskreten Variationsprobleme.

\begin{Definition}
\label{definition:stabile_diskretisierung}
    Sei $\Set{(\mathcal X_{\mathcal N}, \mathcal Y_{\mathcal N})}_{\mathcal N \geq 1}$ eine Folge von endlichdimensionalen Unterräumen mit zugehörigen diskreten inf-sup-Konstanten $\Set{\beta_{\mathcal N}}_{\mathcal N \geq 1}$.
    Wir nennen diese Diskretisierungen \emph{stabil}, wenn ein $\beta > 0$ mit
    \begin{equation}
        \inf_{\mathcal N \geq 1} \beta_{\mathcal N} \geq \beta > 0
    \end{equation}
    existiert.
\end{Definition}


\section{Raum-Zeit-Diskretisierung} % (fold)
\label{section:raum_zeit_diskretisierung}

Wir kehren zu der Raum"=Zeit"=Variationsformulierung \cref{eq:raum_zeit_variationsformulierung} respektive \cref{eq:parametrisches_rz_variationsproblem} der Propagator"=Differentialgleichung aus \cref{chapter:propagator_differentialgleichung} zurück und wollen an dieser Stelle eine Diskretisierung mit Hilfe eines Petrov"=Galerkin"=Verfahrens durchführen.
Dazu konstruieren wir nun endlichdimensionale Unterräume $\mathcal X_{\mathcal N}$ und $\mathcal Y_{\mathcal N}$, für welche wir anschließend Bedingungen angeben, die zu einer stabilen Diskretisierung im Sinne von \cref{definition:stabile_diskretisierung} führen.

Um dies zu bewerkstelligen, greifen wir auf die Charakterisierung der Bochner"=Sobolev"=Räume als Hilbertraum-Tensorprodukte aus \cref{satz:bochner_sobolev_raum_als_tensorprodukt} zurück und können so die nachfolgende Konstruktion in einen rein-räumlichen und einen rein-zeitlichen Anteil zerlegen.

\begin{Korollar}
    Der verwendete Ansatz- und Testraum \cref{eq:ansatzraum_X,eq:testraum_Y} lassen sich auch schreiben als
    \begin{equation}
        \label{eq:ansatzraum_testraum_tensor}
        \begin{aligned}
        \mathcal X &= L_{2}(I; V) \cap H^{1}(I; V')
            = (L_2(I) \otimes V) \cap (H^{1}(I) \otimes V'),\\
        \mathcal Y &= L_{2}(I; V) \times H = (L_{2}(I) \otimes V) \times H.
        \end{aligned}
    \end{equation}
\end{Korollar}

Die nachfolgende Konstruktion orientiert sich an \cite{Andreev:2012uh}.
Für die zeitliche Komponente verwenden wir die zwei endlichdimensionalen Räume $E_{\mathcal K} \subset H^{1}(I)$ und $F_{\mathcal K} \subset L_{2}(I)$ konstruieren, wobei die Dimensionen so gewählt werden, dass
\begin{equation}
    \label{eq:dimensionen_zeitliche_raeume}
    \dim E_{\mathcal K} = \mathcal K + 1, \qquad \dim F_{\mathcal K} = \mathcal K
\end{equation}
gilt.
Die Räume $V, H$ und $V'$ der räumlichen Komponenten können wir aufgrund der Gelfand-Tripel-Struktur alle durch den selben endlichdimensionalen Raum $V_{\mathcal J}$ diskretisieren, welcher die Dimension
\begin{equation}
    \label{eq:dimension_raeumliche_raeume}
    \dim V_{\mathcal J} = \mathcal J
\end{equation}
hat.
Diese Teilräume liefern nun zusammen mit der Tensorprodukt-Darstellung \cref{eq:ansatzraum_testraum_tensor} von Ansatz- und Testraum die Diskretisierungen
\begin{equation}
\label{eq:diskrete_tensor_raueme}
    \mathcal X_{\mathcal N} := E_{\mathcal K} \otimes V_{\mathcal J}, \qquad \mathcal Y_{\mathcal N} := (F_{\mathcal K} \otimes V_{\mathcal J}) \times V_{\mathcal J}
\end{equation}
mit den Dimensionen
\begin{equation}
    \mathcal N := \dim \mathcal X_{\mathcal N} = (\mathcal K + 1) \mathcal J = \mathcal K \mathcal J + \mathcal J = \dim \mathcal Y_{\mathcal N}.
\end{equation}

Nachdem nun geklärt ist, wie die Raum-Zeit-Räume zusammengesetzt werden können, konstruieren wir nun die einzelnen Bauteile.

\subsection*{Zeitliche Komponente}

Für die zeitliche Komponente benötigen wir zunächst eine Diskretisierung des Zeitintervalls $I = [0, T]$ in Form eines nicht notwendigerweise äquidistanten Gitters
\begin{equation}
\label{eq:zeitgitter}
    \mathcal T_{\mathcal K} := \Set{0 = t_0 < t_1 < \dots < t_{\mathcal K - 1} < t_{\mathcal K} = T} \subset I.
\end{equation}

Für die Diskretisierung $E_{\mathcal K}$ des Ansatzraumes verwenden wir stetige, stückweise affine Funktionen, genauer die klassischen Hutfunktionen $\theta_{k}$ auf den Gitterpunkten $t_{k} \in \mathcal T_{\mathcal K}$ für $k = 0, \dots, \mathcal K$.
Diese lassen sich alternativ mittels $\theta_{k}(t_{\tilde{k}}) = \delta_{k \tilde k}$ auch durch das bekannte Kronecker-Delta $\delta_{k \tilde k}$ charakterisieren.
Wir fassen diese Hutfunktionen zu einer Basis $\mathcal B^{E}_{\mathcal K}$ zusammen und definieren damit
\begin{equation}
    \label{eq:zeitanteil_ansatzraum}
    E_{\mathcal K} := \spn \mathcal B^{E}_{\mathcal K} = \spn \Set{ \theta_{k} \given k = 0, \dots, \mathcal K }.
\end{equation}

Für den Testraum-Anteil $F_{\mathcal K}$ verwenden wir stattdessen durch charakteristische Funktionen gegebene stückweise konstante Funktionen $\xi_{k} = \chi_{(t_{k-1}, t_{k})}$ auf den Teilintervallen $(t_{k - 1}, t_{k}) \subset I$ mit den Gitterpunkten $t_{k} \in \mathcal T_{\mathcal K}$.
Erneut fassen wir diese zu einer Basismenge $\mathcal B^{F}_{\mathcal K}$ zusammen und definieren
\begin{equation}
    \label{eq:zeitanteil_testraum}
    F_{\mathcal K} := \spn \mathcal B^{F}_{\mathcal K} = \spn \Set{ \xi_{k} \given k = 1, \dots, \mathcal K}.
\end{equation}

Nach \cite{Andreev:2012ep} führt diese Wahl von Basisfunktionen für Ansatz- und Testraum zu einem Crank-Nicolson-ähnlichen Verfahren, welches auch als Time-Stepping-Verfahren interpretiert werden kann.
Darauf wollen wir an dieser Stelle nicht weiter eingehen, da wir die resultierenden diskreten Raum-Zeit-Variationsprobleme direkt lösen werden.


\subsection*{Räumliche Komponente} % (fold)

Auf die räumliche Diskretisierung im Allgemeinen Fall wollen wir hier nur kurz eingehen.
Hierzu können die meisten von Galerkin-Verfahren bekannten Ansätze verwendet werden, beispielsweise die Bestimmung einer Triangulation von $\Omega$ und anschließende Verwendung von Finiten-Elementen, aber auch globale Basisfunktionen sind denkbar.
Wir werden bei der Stabilitätsuntersuchung im nachfolgenden Abschnitt feststellen, dass das resultierende Raum-Zeit-Verfahren in gewisser Weise modular bezüglich der räumlichen Komponente ist, weswegen wir an dieser Stelle nur eine notationelle Definition tätigen wollen.

Für den räumlichen Anteil definieren wir ebenfalls eine Basis, $\mathcal B^{V}_{\mathcal J}$, und den endlichdimensionalen Raum durch
\begin{equation}
    \label{eq:raeumlicher_anteil}
    V_{\mathcal J} := \spn \mathcal B^{V}_{\mathcal J} = \spn \Set{ \eta_{j} \given j = 1, \dots, \mathcal J}.
\end{equation}


\subsection*{Raum-Zeit-Diskretisierung} % (fold)

Unter Verwendung der Tensorprodukt-Darstellung \cref{eq:ansatzraum_testraum_tensor} können wir nun die beiden einzeln betrachteten Komponenten zu den endlichdimensionalen Raum"=Zeit"=Unterräumen zusammensetzen.
Dazu definieren wir mittels Tensorprodukt zunächst die Basen
\begin{equation}
\label{eq:diskreter_ansatzraum_basis_phi}
\label{eq:diskreter_testraum_basis_psi1}
    \mathcal B^{\mathcal X}_{\mathcal N} := \Set{\theta \otimes \eta \given \theta \in \mathcal B^{E}_{\mathcal K}, \eta \in \mathcal B^{V}_{\mathcal J}}, \quad
    \mathcal B^{\mathcal Y_{1}}_{\mathcal N} := \Set{\xi \otimes \eta \given \xi \in \mathcal B^{F}_{\mathcal K}, \eta \in \mathcal B^{V}_{\mathcal J}}.
\end{equation}
und weiter
\begin{equation}
\label{eq:diskreter_testraum_basis_psi}
    \mathcal B^{\mathcal Y}_{\mathcal N} := (\mathcal B^{\mathcal Y_{1}}_{\mathcal N} \times \Set{ 0 }) \cup (\Set{0} \times \mathcal B^{V}_{\mathcal J}).
\end{equation}
Nach Konstruktion und den Definitionen \cref{eq:diskrete_tensor_raueme} gilt nun
\begin{equation}
    \label{eq:diskreter_ansatz_und_testraum_als_span}
    \mathcal X_{\mathcal N} = E_{\mathcal K} \otimes V_{\mathcal J} = \spn \mathcal B^{\mathcal X}_{\mathcal N},
    \quad
    \mathcal Y_{\mathcal N} = (F_{\mathcal K} \otimes V_{\mathcal J}) \times V_{\mathcal J} = \spn \mathcal B^{\mathcal Y}_{\mathcal N}.
\end{equation}

\subsection*{Stabilität der Diskretisierung} % (fold)

Wie bereits erwähnt, wollen wir an dieser Stelle Bedingungen angeben, unter denen die diskreten Raum-Zeit-Räume $\mathcal X_{\mathcal N}$ und $\mathcal Y_{\mathcal N}$ aus \cref{eq:diskreter_ansatz_und_testraum_als_span} zu stabilen Diskretisierungen im Sinne von \cref{definition:stabile_diskretisierung} führen.
Hierzu verweisen wir erneut auf die Arbeit \cite[Section 5.2]{Andreev:2012ep}, in welcher \citeauthor{Andreev:2012ep} für drei verschiedene Ansätze für die zeitliche Komponente die Stabilität unter gewissen Bedingungen nachweist.
Da für einen korrekten und verständlichen Nachweis dieser Aussagen eine extensive Vorarbeit notwendig ist, verzichten wir an dieser Stelle darauf und verweisen auf obige Arbeit.
Stattdessen beschränken wir uns auf die Einführung des Nötigsten um die Bedingungen anzugeben und kehren bei den numerischen Experimenten noch einmal zur Stabilität zurück.

Für den hier konstruierten Fall führen die Ausführungen in \cite{Andreev:2012ep} zu einer Courant-Friedrichs-Levi-Bedingung, kurz CFL-Bedingung, wie man sie üblicherweise bei der Diskretisierung von hyperbolischen partiellen Differentialgleichung antrifft.
Dazu definieren wir zunächst die maximale Schrittweite des Zeitgitters $\mathcal T_{\mathcal K}$ als
\begin{equation}
    \label{eq:maximale_zeitschrittweite}
    \max \Delta \mathcal T_{\mathcal K} := \max_{k = 1, \dots, \mathcal K} \abs{t_{k} - t_{k - 1}}
\end{equation}
und weiter die sogenannte CFL-Zahl nach \cite[62]{Andreev:2012ep}.

\begin{Definition}
    Seien $\mathcal T_{\mathcal K}$ ein Gitter des Zeitintervalls $I = [0, T]$ und $V_{\mathcal J} \subset V$ ein endlichdimensionaler Unterraum.
    Als \emph{Courant-Friedrichs-Levi-Zahl}, kurz \emph{CFL-Zahl}, der Diskretisierung $(\mathcal X_{\mathcal N}, \mathcal Y_{\mathcal N})$ aus \cref{eq:diskreter_ansatz_und_testraum_als_span} bezeichnen wir
    \begin{equation}
        \label{eq:cfl_zahl}
        \mathrm{CFL}_{\mathcal N} := \max \Delta \mathcal T_{\mathcal K} \sup_{\eta \in V_{\mathcal J} \setminus \Set{0} } \frac{\norm{\eta}_{V}}{\norm{\eta}_{V'}}.
    \end{equation}
\end{Definition}

\begin{Bemerkung}
    Ist $V_{\mathcal J}$ endlichdimensional, dann gilt insbesondere $\mathrm{CFL}_{\mathcal N} < \infty$.
\end{Bemerkung}

Weiter werden wir noch eine gewisse inf"=sup"=Konstante benötigen, welche in \cite[57]{Andreev:2012ep} aus der Konstruktion einer äquivalenten Norm auf $\mathcal X$ resultiert, die dann für den Stabilitätsnachweis \cite[Theorem 5.2.6]{Andreev:2012ep} verwendet wird.

An dieser Stelle benötigen wir die Operatorfamilie $\Set{A(t)}_{t \in I}$ aus \cref{eq:operator_zeit}.
Ohne Einschränkung nehmen wir nach \cref{lemma:transformation_zu_elliptischem_operator} an, dass diese eine G\aa{}rding-Ungleichung mit $\lambda = 0$ erfüllen.
Dadurch sind diese Operatoren nach \cref{korollar:bilinearform_elliptisch} elliptisch und nach dem Satz von Lax-Milgram \cite[Section 6.2.1]{evans2010partial} stetig invertierbar.
Weiter wird die Selbstadjungiertheit aus \cref{lemma:operator_selbstadjungiert} benötigt.
Dies erlaubt es uns aufbauend auf diese Operatoren zwei Skalarprodukte respektive Normen durch
\begin{equation}
    \begin{aligned}
        \skp{v_{1}}{\tilde{v}_{1}}{+} &:= \int_{I} \skp{A(t)v_{1}(t)}{\tilde{v}_{1}(t)}{V' \times V} \diff t, \\
         \norm{v_{1}}^{2}_{+} &:= \skp{v_{1}}{v_{1}}{+},
    \end{aligned}
    \qquad \text{für } v_{1}, \tilde{v}_{1} \in \mathcal Y_{1} := L_{2}(I; V),
\end{equation}
und
\begin{equation}
    \begin{aligned}
        \skp{z}{\tilde{z}}{-} &:= \int_{I} \skp{A(t)^{-1} z}{\tilde z}{V \times V'} \diff t, \\
        \norm{z}_{-}^{2} &:= \skp{z}{z}{-},
    \end{aligned}
    \qquad \text{für } z, \tilde z \in \mathcal Y_{1}' = L_{2}(I; V'),
\end{equation}
zu definieren.
Mit Hilfe dieser Normen definieren wir nun die angesprochene inf"=sup"=Konstante nach \cite[57]{Andreev:2012ep} als
\begin{equation}
    \beta_{\pm}(\mathcal X_{\mathcal N}, \mathcal Y_{\mathcal N}) := \inf_{u \in \mathcal X_{\mathcal N}} \sup_{v \in \mathcal Y_{\mathcal N}} \frac{\int_{I} \skp{u_t(t)}{v_{1}(t)}{V' \times V} \diff t}{\norm{u_t}_{-} \norm{v_{1}}_{+}},
\end{equation}
wobei Infimum und Supremum bezüglich aller Elemente gebildet werden, für die der Nenner nicht Null wird.

Unter Verwendung dieser Definitionen lässt sich letztendlich die nachfolgende Stabilitätsaussage nachweisen.

\begin{Satz}
    Seien $\Set{(\mathcal X_{\mathcal N}, \mathcal Y_{\mathcal N})}_{\mathcal N \geq 1}$ Diskretisierungen der Form \cref{eq:diskreter_ansatz_und_testraum_als_span}.
    Gelten die Bedingungen
    \begin{equation}
        \sup_{\mathcal N \geq 1} \mathrm{CFL}_{\mathcal N} < \infty
        \quad \text{und} \quad
        \inf_{\mathcal N \geq 1} \beta_{\pm}(\mathcal X_{\mathcal N}, \mathcal Y_{\mathcal N}) > 0,
    \end{equation}
    dann existiert eine Konstante $c_{0} > 0$ und es gilt für die diskrete inf"=sup"=Konstante $\beta_{\mathcal N}$ aus \cref{eq:diskrete_inf_sup_kosntante} die Abschätzung
    \begin{equation}
        \beta_{\mathcal N} \geq c_{0} \min\Set{1, \beta_{\pm}(\mathcal X_{\mathcal N}, \mathcal Y_{\mathcal N})} \min\Set{1, \mathrm{CFL}_{\mathcal N}^{-1}} \quad \fa \mathcal N \geq 1.
    \end{equation}

    \begin{Beweis}
        Siehe \cite[Subsection 5.2.2]{Andreev:2012ep}.
    \end{Beweis}
\end{Satz}


\section{Numerische Umsetzung und Experimente} % (fold)
\label{section:galerkin_numerische_umsetzung_und_experimente}

Nachdem nun die benötigten Grundlagen in einem möglichst allgemeinen Rahmen gelegt wurden, widmen wir uns nun der Anwendung dieser auf die schwache parametrische Formulierung der Propagator-Differentialgleichung.

Um diese Parametrisierung numerisch umsetzen zu können, müssen wir zunächst den in \cref{chapter:propagator_differentialgleichung} noch unendlichdimensionalen Parameterraum $\mathcal P$ auf einen endlichdimensionalen einschränken.
Da wir weiter in Einklang mit den Bedingungen aus \cref{section:parametrische_formulierung} bleiben wollen, werden wir dies im Folgenden durch die Wahl einer Dimension $N_{\mathcal P} \in \mathbb{N}$ und der Entwicklungsfunktionen $\varphi_{j} = 0$ für alle $j > N_{\mathcal P}$ motivieren.

Wir wiederholen an dieser Stelle das parametrische Raum"=Zeit"=Variationsproblem und führen die benötigten Definitionen noch einmal in Kurzform durch.
Im Nachfolgenden seien $\mathcal X$ und $\mathcal Y$ die aus \cref{eq:ansatzraum_X,eq:testraum_Y} bekannten Ansatz- respektive Testräume.

\begin{Bemerkung}
    Mit $N_{\mathcal P} \in \mathbb{N}$ bezeichnen wir die Anzahl der Parameter.
    Weiter sei $\mathcal P = [-1, 1]^{N_{\mathcal P}}$ der sogenannte Parameterraum und durch
    \begin{equation}
        \mathcal B^{\omega}_{N_{\mathcal P}} := \Set{ \varphi_{j} \in L_{\infty}(\Omega) \given j = 1, \dots, N_{\mathcal P}}
    \end{equation}
    eine endliche Menge von Feld-Entwicklungsfunktionen gegeben.
\end{Bemerkung}

\begin{Bemerkung}
    Das parametrische Raum"=Zeit"=Variationsproblem lautet
    \begin{equation}
    \label{eq:wiederholung_variationsproblem}
        \text{Sei }\bm \sigma \in \mathcal P, \text{ finde } u(\sigma) \in \mathcal X \colon \quad b(u(\bm \sigma), v; \bm \sigma) = f(v) \quad \fa v \in \mathcal Y,
    \end{equation}
    wobei $b$ und $f$ wie in \cref{definition:parametrische_rz_variationsformulierung} gegeben seien.
\end{Bemerkung}

\begin{Lemma}
\label{lemma:bilinearform_affin_parametrisch}
    Die parametrische Bilinearform $b$ aus \cref{eq:parametrisches_rz_variationsproblem:lhs} ist unter diesen Gegebenheiten affin vom Parameter $\bm \sigma \in \mathcal P$ abhängig, genauer gilt
    \begin{equation}
        b(\blank, \blank; \bm \sigma) = b_{0}(\blank, \blank) + \sum_{j = 1}^{N_{\mathcal P}} \sigma_{j} b_{j}(\blank, \blank)
    \end{equation}
    mit parameterunabhängigen Bilinearformen $b_{j} \colon \mathcal X \times \mathcal Y \to \mathbb{R}$, $j = 0, \dots, N_{\mathcal P}$.

    \begin{Beweis}
        Ohne Einschränkung nehmen wir an, dass das parametrische Raum"=Zeit"=Feld $\omega$ die Darstellung
        \begin{equation}
            \omega \colon I \times \Omega \times \mathcal P \to \mathbb{R}, \quad
            \omega(t, \vec{x}; \bm \sigma) = \sum_{j = 1}^{N_{\mathcal P}} \sigma_{j} \chi_{j}(t) \varphi_{j}(\vec x)
        \end{equation}
        mit charakteristischen Funktionen $\chi_{j} \in \Set{\chi_{I_{1}}, \chi_{I_{2}}}$ für $j = 1, \dots, N_{\mathcal P}$ hat.
        Damit lässt sich die Bilinearform $b$ der parametrischen schwachen Formulierung \cref{eq:parametrisches_rz_variationsproblem:lhs} in eine bezüglich des Parameters $\bm \sigma$ affine Form bringen.
        Definiere dazu die Bilinearformen
        $b_{j} \colon \mathcal X \times \mathcal Y \to \mathbb{R}$ durch
        \begin{equation}
            \begin{aligned}
                b_{0} &:= \int_{I} \left[ \skp{u_{t}}{v_{1}}{V' \times V} + c\skp{\grad u}{\grad v_{1}}{H} + \mu \skp{u}{v_{1}}{H} \right] \diff t + \skp{u(0)}{v_{2}}{H},\\
                b_{j} &:= \int_{I} \chi_{j} \skp{\varphi_{j}u}{v_{1}}{H} \diff t, \quad j = 1, \dots, N_{\mathcal P}.
            \end{aligned}
        \end{equation}
        Unter Verwendung dieser gilt nun offenbar
        \begin{equation}
            \begin{aligned}
                b(u, v; \bm \sigma)
                &= \int_{I} \left[ \skp{u_{t}}{v_{1}}{V' \times V} + a(u, v_{1}; \bm \sigma) \right] \diff t + \skp{u(0)}{v_{2}}{H}
                \\&= \int_{I} \left[ \skp{u_{t}}{v_{1}}{V' \times V} + c\skp{\grad u}{\grad v_{1}}{H} + \mu \skp{u}{v_{1}}{H} \right] \diff t + \skp{u(0)}{v_{2}}{H}
                \\&\qquad + \sum_{j = 1}^{N_{\mathcal P}} \sigma_{j} \int_{I} \chi_{j} \skp{\varphi_{j}u}{v_{1}}{H} \diff t
                \\&= b_{0}(u, v) + \sum_{j = 1}^{N_{\mathcal P}} \sigma_{j} b_{j}(u, v).
            \end{aligned}
        \end{equation}
    \end{Beweis}
\end{Lemma}

Um nun unter Verwendung der endlichdimensionalen Ansatz- und Testraumbasen \cref{eq:diskreter_ansatzraum_basis_phi,eq:diskreter_testraum_basis_psi} eine Diskretisierung von \cref{eq:wiederholung_variationsproblem} zu erhalten, nutzen wir die erneut die Tensorprodukt"=Struktur von $\mathcal X^{\mathcal N}$ und $\mathcal Y^{\mathcal N}$ und die Tatsache, dass Zeit- und Ortsableitungen in der betrachteten Variationsformulierung nur getrennt vorkommen.
Dies ermöglicht die Berechnung von $\mat B(\bm \sigma) \in \mathbb{R}^{\mathcal N \times \mathcal N}$ und $\vec{f} \in \mathbb{R}^{\mathcal N}$ mittels Kronecker-Produkten gewisser Matrizen und Vektoren der zeitlichen und räumlichen Diskretisierung.

\paragraph{System-Matrix} % (fold)

Die System-Matrix $\mat{B}(\bm \sigma) \in \mathbb{R}^{\mathcal N \times \mathcal N}$ erhalten wir für $\phi_{m} \in \mathcal B^{\mathcal X}_{\mathcal N}$ und $\psi_{n} \in \mathcal B^{\mathcal Y}_{\mathcal N}$ durch
\begin{equation}
    \mat{B}(\bm \sigma) := \left[ b(\phi_{m}, \psi_{n}) \right]_{n, m = 1, \dots, \mathcal N},
\end{equation}
was aufgrund von \cref{lemma:bilinearform_affin_parametrisch} mit Hilfe der Matrizen
\begin{equation}
    \mat{B}_{j} := \left[ b_{j}(\phi_{m}, \psi_{n}) \right]_{n,m = 1, \dots, \mathcal N}, \quad j = 1, \dots, N_{\mathcal P}
\end{equation}
auch in der affin-parametrischen Darstellung
\begin{equation}
    \mat{B}(\bm \sigma) = \mat{B}_{0} + \sum_{j = 1}^{N_{\mathcal P}} \sigma_{j} \mat{B}_{j}
\end{equation}
geschrieben werden kann.

Wir bestimmen nun die für die Berechnung dieser affinen Darstellungen die benötigten \enquote{Bausteine}.
Dazu definieren wir für den räumlichen Anteil die Matrizen
\begin{equation}
    \mat{M}_{x} := \left[ \skp{\eta_{m}}{\eta_{n}}{H} \right]_{m,n=1,\dots,\mathcal J}
\end{equation}
und
\begin{equation}
    \mat{A}_{x} := \left[ \skp{\grad \eta_{m}}{\grad \eta_{n}}{H} \right]_{m,n=1,\dots,\mathcal J}
\end{equation}
sowie für den räumlichen Anteil die Matrizen
\begin{equation}
    \mat{M}_{t} := \left[ \skp{\theta_{m}}{\xi_{n}}{L_{2}(I)} \right]_{n = 1, \dots, \mathcal K, m = 0, \dots, \mathcal K},
\end{equation}
\begin{equation}
    \mat{C}_{t} := \left[ \skp{\theta_{m}'}{\xi_{n}}{L_{2}(I)} \right]_{n = 1, \dots, \mathcal K, m = 0, \dots, \mathcal K},
\end{equation}
\begin{equation}
    \mat{A}_{t} := \left[ \skp{\theta_{m}'}{\xi_{n}'}{L_{2}(I)} \right]_{n = 1, \dots, \mathcal K, m = 0, \dots, \mathcal K}.
\end{equation}


Um nun mit Hilfe der in \cref{eq:diskreter_ansatzraum_basis_phi,eq:diskreter_testraum_basis_psi} definierten Basen $\mathcal B^{\mathcal X}_{\mathcal N}$ und $\mathcal B^{\mathcal Y}_{\mathcal N}$ zu einem diskreten Variationsproblem zu gelangen, müssen wir, wie bei Galerkin-Verfahren üblich, die rechte und die linke Seite des Variationsproblems für alle $\phi \in \mathcal B^{\mathcal X}_{\mathcal N}$ und $\psi \in \mathcal B^{\mathcal Y}_{\mathcal N}$ auswerten.
Dies liefert uns dann ein lineares Gleichungssystem
\begin{equation}
    \mat{B(\bm \sigma)} \vec{x} = \vec{f}.
\end{equation}

Dies tun wir, indem wir die affine Zerlegung von $b$ ausnutzen.
Definiere
\begin{equation}
    \mat{B}_{0} := [b_{0}(\phi_{k}, \psi_{l})]_{l, k}
\end{equation}
und
\begin{equation}
    \mat{B}_{j} := [b_{j}(\phi_{k}, \psi_{l})]_{l, k}.
\end{equation}

\subsection{Sammlung zur numerischen Umsetzung} % (fold)
\label{sub:sammlung_zur_numerischen_umsetzung}

\begin{Lemma}[Berechnung der Rieszchen Darstellung]
\label{lemma:berechnung_rieszsche_darstellung}
    Sei $X$ ein endlichdimensionaler Hilbertraum mit Basis ${\phi_i}_{i=1}^{N}$.
    Sei weiter $g \in X'$.
    Der Koeffizientenvektor $\vec{v} \in \mathbb{R}^{N}$ der Rieszschen Darstellung $v_g = \sum_{i=1}^{N} v_{i} \phi_{i} \in X$ von $g$, das heißt, es gilt $\skp{v_g}{w}{X} = \skp{g}{w}{X' \times X}$ für alle $w \in X$, lässt sich durch das Gleichungssystem $\mat{K}\vec{v} = \vec{g}$ berechnen, wobei $\mat{K} = [\skp{\phi_{i}}{\phi_{j}}{X}]_{i,j}$ die Massematrix zum inneren Produkt auf $X$ sei und weiter $\vec{g} = [\skp{g}{\phi_{i}}{X' \times X}]_{i}$ sei.
\end{Lemma}

\begin{Lemma}[Diskrete $\mathcal{X}$-Norm]
% todo: fixme
    Sei $\mathcal{X}^{\mathcal{N}} = \spn\Set{ \phi_{i} \given i = 1 \dots \mathcal N } \subset \mathcal X$ ein endlichdimensionaler Unterraum.
    Die $\mathcal X$-Norm aus \eqref{eq:gl:le:ansatzraum_X_norm}
    wird für den Unterraum $\mathcal{X}_{\mathcal N}$ durch den folgenden Operator
    \begin{equation}
        \mat{M} = \mat{M}_{t} \otimes (\mat{M}_{x} + \mat{A}_{x}) + \mat{A}_{t} \otimes (\mat{M}_{x} (\mat{M}_{x} + \mat{A}_{x})^{-1} \mat{M}_{x})
    \end{equation}
    induziert.
\end{Lemma}

\begin{Lemma}[Diskrete $\mathcal{Y}$-Norm]
% todo: fixme
    Sei bla.
    Die $\mathcal{Y}_{\mathcal N}$-Norm aus \eqref{eq:testraum_Y_skalarprodukt} wird durch den folgenden Operator
    \begin{equation}
        \mat{N} = \begin{pmatrix}
            \mat{M}_{t} \otimes (\mat{M}_{x} + \mat{A}_{x}) & \mat{0} \\
            \mat{0} & \mat{M}_{x}.
        \end{pmatrix}
    \end{equation}
    induziert.
\end{Lemma}

