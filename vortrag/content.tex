\begin{frame}
        \titlepage
\end{frame}

\begin{frame}[t]
    \frametitle{Overarching goal}

    We want to study the phase separation behavior of polymers.

    \vfill

    \begin{columns}
        \begin{column}{0.6\textwidth}
            \begin{itemize}
                \item A \emph{polymer} is a large molecule, composed of many repeated subunits (\emph{monomers}, smaller molecules).
                \item Monomers interact with each other in and across polymers.
                \item \onslide<2-> Simplest kinds of polymers are of \emph{linear chain} type.
                \item Stochastic models (e.g. random walks, ideal chain models) are used to model these.
            \end{itemize}
        \end{column}
        \begin{column}{0.4\textwidth}
            \centering
            \includegraphics[width=0.9\textwidth]{figures/Single_Polymer_Chains_AFM.jpg}
        \end{column}
    \end{columns}
\end{frame}

\begin{frame}[t]
    \frametitle{Overarching goal}

    \vfill

    \begin{itemize}
        \item Polymer melts (liquid phase) can exhibit different separation behaviors:
        \begin{itemize}
            \item \emph{macrophase separation:} liquid-liquid separation (e.g. like water / oil); mostly seen in blends of different polymers.
            \item \emph{microphase separation:} distinct ordering of individual polymer chains.
        \end{itemize}
        \onslide<2->
        \item We are interested in the microphase separation of \emph{diblock copolymers}.
        \item These consist of two types of monomers (e.g. A and B) forming two large blocks.
    \end{itemize}

    \centering
    \includegraphics[width=0.8\textwidth]{figures/copoly2.pdf}
\end{frame}

\begin{frame}[t]
    \frametitle{Overarching goal}

    Several types of microphase separation observable depending on the properties of the polymers, e.g. gyroid:

    \centering
    \includegraphics[scale=0.15]{figures/gyroid_separation.png}

    Can we predict the microphase separation of polymers through theoretical models?
\end{frame}

\begin{frame}[t]
    \frametitle{So, what's self-consistent field theory?}

    Self-consistent field theory (SCFT) allows us to study the behavior of large stochastic models through simplified models.

    \onslide<2->
    \vfill
    \begin{itemize}
        \item \emph{Goal:} study a complex stochastic model (e.g. a polymer melt) with a huge number of small individual interacting components (e.g. monomers).
        \item \emph{Idea:} instead of considering interactions between all the individual components, approximate the effect on a given individual by a single averaged effect (so called \emph{external field}).
    \end{itemize}

    \vfill
    \centering
    \onslide<3->
    \emph{This reduces a many-body problem to a one-body problem!}
\end{frame}

\begin{frame}[t]
    \frametitle{So, what's self-consistent field theory?}

    How can this be used?


    \begin{itemize}
        \item Model leads to a free energy functional depending on external fields $w_{A}$ and $w_{B}$, where saddle points correspond to stable microphase separations.
        \item Allows an iterative scheme that adjusts the external fields until these satisfy some saddle point equations (\emph{self consistency}).
    \end{itemize}
\end{frame}

\begin{frame}[t]
    \frametitle{So, what's self-consistent field theory?}

    Most costly part of each iteration:
    calculating a solution to the \emph{modified diffusion equation} (MDE)
        \begin{equation}
            \frac{\partial}{\partial s}q(\vec{r}, s) = c\,\Delta q(\vec{r}, s) - w(\vec{r}, s)q(\vec{r}, s), \quad q(\vec{r}, 0) = 1,
        \end{equation}
    with $c > 0$ and
    \onslide<2->
    \begin{itemize}
        \item the normalized polymer chain contour $s \in [0, 1]$,
        \item a position $\vec{r}$ in a small volume cell $\Omega \subset \mathbb{R}^{n}$ (bounded domain),
        \item \onslide<3-> the combined external field
        \begin{equation}
            w(\vec{r}, s) = \begin{cases}
                w_{A}(\vec{r}), & 1 \leq s < f \\
                w_{B}(\vec{r}), & f \leq s \leq 1
            \end{cases}
        \end{equation}
        with the ratio $f \in [0, 1]$ of $A$-type monomers in the polymer chain.
    \end{itemize}
\end{frame}

\begin{frame}[t]
    \frametitle{So, what's self-consistent field theory?}

    \vfill

    \begin{itemize}
        \item MDE has to be solved \emph{several hundred / thousand times} with mostly slight variations in the external fields.
        \item Some kind of model reduction resulting in a speed up of the iterative scheme would be useful.
    \end{itemize}

    \vfill
    \onslide<2->
    Let's look at some examples that can be obtained by the iterative scheme in the case of one spatial dimension
    (using a de facto default pseudospectral method for the MDE).
    \vfill
\end{frame}

\begin{frame}[t]
    \frametitle{Example}

    \begin{itemize}
        \item Let $\Omega = [0, 10]$ and $f = 1/2$.
        \item \uncover<2->{On the left: the final fields $w_A$ and $w_B$.}
        \item \uncover<3->{On the right: the corresponding Fourier coefficients (absolute value, in the order $\cos(2 \pi x), \sin(2 \pi x), \cos(4 \pi x), \dots$).}
    \end{itemize}

    \vfill
    \begin{columns}
    \begin{column}{0.5\textwidth}
        \uncover<2->{\includegraphics[width=\textwidth]{figures/scft1.pdf}}
    \end{column}
    \begin{column}{0.5\textwidth}
        \uncover<3->{\includegraphics[width=\textwidth]{figures/scft2.pdf}}
    \end{column}
    \end{columns}
\end{frame}

\begin{frame}[t]
    \frametitle{Example}

    And now the same with $f = 1/3$.

    \vfill
    \begin{columns}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=\textwidth]{figures/scft_example2_fields.pdf}
    \end{column}
    \begin{column}{0.5\textwidth}
        \includegraphics[width=\textwidth]{figures/scft_example2_fourier_coeffs.pdf}
    \end{column}
    \end{columns}
\end{frame}

\begin{frame}[t]
    \frametitle{What's striking?}

    \begin{itemize}
        \item External fields often exhibit regularity and some kind of symmetry.
    \end{itemize}

    \vfill

    \begin{columns}
        \begin{column}{0.5\textwidth}
            \includegraphics[width=\textwidth]{figures/scft1.pdf}
        \end{column}
        \begin{column}{0.5\textwidth}
            \includegraphics[width=\textwidth]{figures/scft_example2_fields.pdf}
        \end{column}
    \end{columns}

    \onslide<2->
    Maybe this can be used as a leverage point for a model reduction by only considering the functions with significant coefficients\\
    $\rightarrow$ model reduction by \emph{reduced basis method}.
\end{frame}

\begin{frame}[t]
    \frametitle{Intermission: Reduced Basis Method}
    \framesubtitle{Preliminaries}

    Given a \emph{parametric variational problem}
    \begin{equation}
        b(u, v; \bm \sigma) = f(v; \bm \sigma), \qquad u \in \mathcal X,~v \in \mathcal Y,
    \end{equation}
    where
    \begin{itemize}
        \item $\mathcal X, \mathcal Y$ are Hilbert spaces,
        \item $\mathcal P \subset \mathbb{R}^{P}$, $P \in \mathbb{N}$, is a closed parameter space,
        \item $b \colon \mathcal X \times \mathcal Y \times \mathcal P \to \mathbb{R}$ is a parametric continuous bilinear form,
        \item $f \colon \mathcal Y \times \mathcal P \to \mathbb{R}$ is a parametric continuous linear functional.
    \end{itemize}

    \onslide<2>
    Let's assume
    \begin{equation}
        \beta(\bm \sigma) := \infsup{u \in \mathcal X}{v \in \mathcal Y} \frac{b(u, v; \bm \sigma)}{\norm{u}_{\mathcal X}\norm{v}_{\mathcal Y}}  > 0 \qquad \text{for all } \bm \sigma \in \mathcal P.
    \end{equation}
    $+$ some minor assumptions $\Rightarrow$ for every $\bm \sigma \in \mathcal P$ exists a unique solution $u(\bm \sigma)$.
\end{frame}

\begin{frame}[t]
    \frametitle{Intermission: Reduced Basis Method}
    \framesubtitle{Basic idea}

    \onslide
    Let's assume we want to compute the solution $\bm \sigma \mapsto u(\bm \sigma)$ in real time or for lots of different parameters $\bm \sigma \in \mathcal P$\\
    $\rightarrow$ standard Galerkin methods are likely too slow!

    \begin{itemize}
        \item \onslide<2->Let $\mathcal M := \Set{ u(\bm \sigma) \given \bm \sigma \in \mathcal P }$.
        \item Depending on the properties of the variational problem, $\mathcal M$ is often a \emph{smooth manifold with low dimension}.
        \item This can be used for model reduction: instead of $\mathcal X$ use $\mathcal M$ as the ansatz space!
    \end{itemize}

    \vfill

    \onslide<3->
    Further we won't use the continuous variational problem, but instead the \emph{truth variational problem} based on a high dimensional Galerkin method:
    \begin{equation}
        b(u, v; \bm \sigma) = f(v; \bm \sigma), \qquad u \in \mathcal X_{\mathcal N}, v \in \mathcal Y_{\mathcal N},
    \end{equation}
    with subspaces $\mathcal X_{\mathcal N} \subset \mathcal X$, $\mathcal Y_{\mathcal N} \subset \mathcal Y$.
\end{frame}

\begin{frame}[t]
    \frametitle{Intermission: Reduced Basis Method}
    \framesubtitle{Basic idea}

    The reduced basis method consists of two stages:

    \begin{itemize}
        \item \onslide<2-> \emph{Offline stage:} Construction of \enquote{optimal} reduced basis spaces $\mathcal X_{N} := \Set{u_{\mathcal N}(\bm \sigma_n) \given n = 1, \dots, N} \subset \mathcal M_{\mathcal N}$ and $\mathcal Y_{N} \subset \mathcal Y_{\mathcal N}$ with low dimension $N \ll \mathcal N$.
        \item \onslide<3-> \emph{Online stage:} Given a parameter $\bm \sigma \in \mathcal P$, compute the rb-solution $u_{N}(\bm \sigma)$ and a certified bound for the error $\norm{u_{N}(\bm \sigma) - u_{\mathcal N}(\bm \sigma)}_{\mathcal X}$ \\(both independent of $\mathcal N$).
    \end{itemize}
    \centering
    $\;$\\[-3.7em]
    \onslide<2-> \includegraphics[width=0.58\textwidth]{figures/rb.pdf}
\end{frame}

\begin{frame}[t]
    \frametitle{Intermission: Reduced Basis Method}
    \framesubtitle{Certified error bound}
    Let $r_{N} \colon \mathcal Y_{\mathcal N} \times \mathcal P \to \mathbb{R}$ be the \emph{residual}
    \begin{equation}
        r_{N}(v; \bm \sigma) := b(u_{\mathcal N}(\bm \sigma) - u_{N}(\bm \sigma), v; \bm \sigma) = f(v; \bm \sigma) - b(u_{N}(\bm \sigma), v; \bm \sigma).
    \end{equation}
    $\Rightarrow$ continuous linear functional for every $\bm \sigma \in \mathcal P$.

    \onslide<2>
    Standard theorems lead to \emph{a posteriori error bound}
    \begin{equation}
        \norm{u_{N}(\bm \sigma) - u_{\mathcal N}(\bm \sigma)}_{\mathcal X} \leq \frac{\norm{r_{N}(\blank; \bm \sigma)}_{\mathcal Y_{\mathcal N}'}}{\beta_{\mathrm{LB}}(\bm \sigma)} =: \Delta_{N}(\bm \sigma),
    \end{equation}
    where
    \begin{itemize}
        \item the norm of the residual can be efficiently computed through the Riesz representation theorem,
        \item $\beta_{\mathrm{LB}}(\bm \sigma)$ is a computable lower bound for $\beta(\bm \sigma)$.
    \end{itemize}
\end{frame}

\begin{frame}[t]
    \frametitle{Intermission: Reduced Basis Method}
    \framesubtitle{Inf-sup-constant}

    Problem: how to compute $\beta_{\mathrm{LB}}(\bm \sigma)$ efficiently?

    \vfill
    \onslide<2->
    Default: \emph{successive constraint method}.

    \begin{itemize}
        \item Reinterpret the calculation of $\beta(\bm \sigma)$ as an optimization problem
        \\$\rightarrow$ linear objective function, but feasible region in general not a convex polytope.
        \item \onslide<3->\emph{Offline stage:} Construct \enquote{optimal} lower and upper bounds for the feasible region.
        \item \emph{Online stage:} Compute $\beta_{\mathrm{LB}}(\bm \sigma)$ through small linear program.
    \end{itemize}

    \vfill
\end{frame}

\begin{frame}[t]
    \frametitle{Intermission: Reduced Basis Method}
    \framesubtitle{Offline and online stage}

    Offline stage of RBM needs a discrete \enquote{training set} $\mathcal P_{\mathrm{train}} \subset \mathcal P$.\newline
    \emph{Iterative greedy scheme}, start with random $\bm \sigma_{1} \in \mathcal P_{\mathrm{train}}$, $\mathcal X_{1} := \Set{u_{\mathcal N}(\bm \sigma_{1})}$:\\[0em]
    \begin{enumerate}
        \item find $\bm \sigma_{N + 1} := \argmax_{\bm \sigma \in \mathcal P_{\mathrm{train}}} \Delta_{N}(\bm \sigma)$,
        \item set $\mathcal X_{N + 1} := \spn (\mathcal X_{N} \cup \Set{u_{\mathcal N}(\bm \sigma_{N + 1})})$,
        \item repeat until maximum in step 1 is smaller than a given tolerance.
    \end{enumerate}
    $\rightarrow$ computationally intensive part.
    \vfill

    \onslide<2->
    Online stage, given a $\bm \sigma \in \mathcal P$:\\[0em]
    \begin{enumerate}
        \item solve reduced basis system for $u_{N}(\bm \sigma) \in \mathcal X_{N}$,
        \item compute certified error bound $\Delta_{N}(\bm \sigma)$.
    \end{enumerate}
    \emph{$\rightarrow$ runtime depends only on low dimension $N$, not $\mathcal N$}.
\end{frame}

\begin{frame}[t]
    \frametitle{Intermission: Reduced Basis Method}
    \framesubtitle{Examples}

    Typical results of the offline stage, one dimensional parameter space.

    \centering
    \includegraphics<1>[width=0.9\textwidth]{figures/1d_par_s_1.pdf}
    \includegraphics<2>[width=0.9\textwidth]{figures/1d_par_s_2.pdf}
    \includegraphics<3>[width=0.9\textwidth]{figures/1d_par_s_3.pdf}
    \includegraphics<4>[width=0.9\textwidth]{figures/1d_par_s_4.pdf}
\end{frame}

\begin{frame}[t]
    \frametitle{Intermission: Reduced Basis Method}
    \framesubtitle{Examples}

    And now a four dimensional parameter space.

    \centering
    \includegraphics[width=0.9\textwidth]{figures/ch5ex2_rbm_error.pdf}
\end{frame}


\begin{frame}[t]
    \frametitle{Back to the SCFT}

    What we've already done:

    \begin{itemize}
        \item<1-> Derived a \emph{space-time variational formulation} (STVP) of the MDE based on \emph{Bochner spaces}.
        \item<2-> Replaced the fields $w_A, w_B$ with parametric functions
        \begin{equation}
            w(\bm \sigma) = \sum_{j = 1}^{N} \sigma_{j} \phi_{j},
        \end{equation}
        where $N \in \mathbb{N} \cup \Set{ \infty }$, $\bm \sigma \in [-1, 1]^{N}$ and $\phi_{j} \in L_{\infty}(\Omega)$, $j = 1, \dots, N$.
        \item<2-> Shown that the solution of the STVP depends \emph{analytically} on the parameters (given some restrictive sufficient conditions).
        \item<3-> Applied a \emph{Petrov-Galerkin} method to solve the STVP.
        \item<3-> Experimented with the application of the reduced basis method on the STVP.
    \end{itemize}

\end{frame}

\begin{frame}[t]
    \frametitle{Back to the SCFT}

    Problems encountered so far:

    \begin{itemize}
        \item<1-> The fact that $\mathcal X \neq \mathcal Y$ complicates lots of things.
        \item<2-> Most suitable Petrov-Galerkin methods aren't unconditionally stable.
        \item<3-> Successive constraint method suffers from curse of dimensionality and is quite slow for more than a handful of parameters.
        \\ $\rightarrow$ a priori knowledge about field expansion functions required to reduce number of parameters.
    \end{itemize}

\end{frame}
