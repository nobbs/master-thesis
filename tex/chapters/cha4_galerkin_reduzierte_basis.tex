%!TEX root = ../main.tex

\iftoggle{dictum}{
    \setchapterpreamble[ul][0.6\textwidth]{%
        \dictum[Alfréd Rényi]{\enquote{A mathematician is a device for turning coffee into theorems.}}
        \vspace*{2\baselineskip}
    }
}{}
\chapter{Galerkin-Verfahren und Reduzierte-Basis-Methode} % (fold)
\label{cha:grb:galerkin_und_reduzierte_basis}

\section*{Noch zu erledigen in diesem Kapitel} % (fold)

\begin{enumerate}
    \item Galerkin-Verfahren
    \item Reduzierte-Basis-Methode
    \begin{enumerate}
        \item Einführung und Motivation
        \item POD bzw. Greedy-Ansatz erklären
        \item Fehlerschätzer etc.
    \end{enumerate}
    \item Eindimensionales Beispiel durchrechnen (oder in eigenes Kapitel?)
\end{enumerate}

% section noch_zu_erledigen_in_diesem_kapitel (end)

\clearpage

In diesem Kapitel wiederholen wir das in der Numerik wohlbekannte Galerkin-Verfahren und führen anschließend die darauf aufbauende Reduzierte-Basis-Methode ein.
Dies wird, wie bereits bei den größtenteils funktionalanalytischen Grundlagen in \cref{cha:gl:grundlagen}, möglichst allgemein gehalten.

Als Quellen hierfür dienten die Arbeiten von \textcite{Braess:2007wm,Patera:2007un,Quarteroni:2011jm}.

Wir konzentrieren uns dabei auf das folgende abstrakte Variationsproblem:
Seien $U$ und $V$ zwei Hilberträume mit entsprechenden Skalarprodukten $\skprod{\blank}{\blank}$ und Normen $\norm{\blank}$, welche wie zuvor durch entsprechende Indizes gekennzeichnet werden.
Weiter seien $b \in \mathcal L(U \times V)$ eine stetige Bilinearform und $f \in V'$ ein stetiges Funktional.
Gesucht ist eine Lösung $u \in U$ von
\begin{equation}
\label{eq:grb:abstraktes_variationsproblem}
    b(u, v) = f(v) \quad \fa v \in V.
\end{equation}

\section{Galerkin-Verfahren} % (fold)
\label{sec:grb:gv:galerkin_verfahren}

Dieser Abschnitt führt in das sogenannte Petrov-Galerkin-Verfahren ein, welches ein Speziallfall des in der Numerik bekannten Galerkin-Verfahrens ist.
Dabei orientieren wir uns hauptsächlich an der Arbeit von \textcite[Section 3.1]{Nochetto:2009il}.

Das Ziel der Galerkin-Verfahren ist es, die eigentlich unendlichdimensionalen Variationsprobleme, wie sie beispielsweise in \cref{cha:gl:grundlagen} vorgestellt wurden, durch endlichdimensionale Approximationen der dabei vorkommenden Funktionenräume in diskrete Probleme zu verwandeln und diese dann numerisch zu lösen.
Dabei müssen die endlichdimensionalen Unterräume intelligent gewählt werden, denn diese entscheiden maßgeblich über die Güte der approximativen Lösungen, genauer über die Stabilität, Konvergenz und vor allem auch die Lösbarkeit der diskreten Probleme.

\subsection{Grundlagen} % (fold)
\label{sub:grb:gv:grundlagen}

Wir beginnen nun mit der Beschreibung der Petrov-Galerkin-Verfahren.

Weiter bezeichnen wir mit $U_{N} \subset U$ und $V_{M} \subset V$, wobei $N, M \in \mathbb{N}$ seien, endlichdimensionale Unterräume dieser Hilberträume, genauer sei $\dim U_{N} = N$ und $\dim V_{M} = M$.
Unser Ziel ist es nun, mit Hilfe dieser Unterräume ein unendlichdimensionales Variationsproblem auf ein lineares Gleichungssystem in $\mathbb{R}^{N \times M}$ runterzubrechen.

\begin{Definition}[Diskrete Lösung]
\label{def:grb:gv:disrekte_loesung}
    Seien $U, V$ Hilberträume, $N, M \in \mathbb{N}$ natürliche Zahlen und $U_{N} \subset U$ sowie $V_{M} \subset W$ endlichdimensionale Unterräume.
    Seien weiter $b \in \mathcal L(U \times V)$ eine stetige Bilinearform und $f \in V'$ ein stetiges lineares Funktional.
    Als \emph{diskrete Lösung}, oder auch \emph{Petrov-Galerkin-Lösung}, bezeichnen wir eine Lösung $u_{N} \in U_{N}$ von
    \begin{equation}
        \label{eq:grb:gv:diskretes_problem}
        b(u_{N}, v) = f(v) \quad \fa v \in V_{M},
    \end{equation}
    falls diese existiert.
\end{Definition}

Stimmen bei obiger Diskretisierung die beiden Hilberträume $U$ und $V$ überein und sind die endlichdimensionalen Unterräume $U_{N}, V_{M}$ so gewählt, dass diese ebenfalls übereinstimmen, insbesondere also die selbe Dimension $N = M$ haben, und ist weiter die Bilinearform $b(\blank, \blank)$ symmetrisch und elliptisch, dann spricht man von einem Ritz-Galerkin-Verfahren.
Diese haben die sehr angenehme Eigenschaft, dass aus der Lösbarkeit des eigentlichen Variationsproblems auch die Lösbarkeit des diskreten Problems folgt, da die Elliptizität von $b(\blank, \blank)$ sich auch auf Unterräume überträgt.
Allerdings tritt dieser Fall bei der Betrachtung von Variationsformulierungen parabolischer partieller Differentialgleichungen im Allgemeinen aber nicht auf.

Bei der Betrachtung von Petrov-Galerkin-Verfahren folgt die Lösbarkeit des diskreten Systems im Allgemeinen nicht aus der Lösbarkeit des Variationsproblems.
Erfüllt die Bilinearform $b(\blank, \blank)$ beispielsweise die Voraussetzungen für das \acl{bnb}, \cref{satz:gl:le:bnb_theorem}, insbesondere also die inf-sup-Bedingung \cref{satz:gl:le:bnb_theorem_bedingung_inf_sup}, dann gilt dies nicht automatisch für die Unterräume $U_{N}$ und $V_{M}$.
Wir charakterisieren nun, unter welchen Bedingungen eine diskrete Lösung existiert.

\mdo{Gilt das überhaupt für verschiedene Dimensionen? In der Quelle wurde alles für N = M gemacht.}

Dazu benötigen wir, wie so oft, den zu der Bilinearform $b$ zugehörigen stetigen linearen Operator $B \in \mathcal L(U, V')$, beziehungsweise hier den diskreten Operator $B_{N} \in \mathcal L(U_{N}, V_{N}')$, welcher durch
\begin{equation}
    \skp{B_{N} u}{v}{V_{N}' \times V_{N}} = b(u, v) \quad \fa u \in U_{N}, ~v \in V_{N},
\end{equation}
definiert ist.

\begin{Satz}[Existenz und Eindeutigkeit der diskreten Lösung]
\label{satz:grb:gv:existenz_eindeutigkeit_der_disrekten_loesung}
    Seien $U_{N} \subset U$ und $V_{N} \subset V$ endlichdimensionale Unterräume.
    Sei weiter $f \in V_{N}'$ ein stetiges lineares Funktional.
    Dann existiert genau dann eine diskrete Lösung $u_{N} \in U_{N}$ von
    \begin{equation}
    \label{eq:grb:gv:diskretes_problem}
        b(u_{N}, v) = f(v) \quad \fa v \in V_{N},
    \end{equation}
    wenn $B_{N}$ injektiv ist, das heißt, wenn für jedes $0 \neq u \in U_{N}$ ein $v \in V_{N}$ existiert, so dass $b(u, v) \neq 0$ gilt.

    \begin{Beweis}
        Offensichtlich ist die Lösbarkeit von \cref{eq:grb:gv:diskretes_problem} äquivalent dazu, dass $B_{N}$ ein Isomorphismus ist.
        Da es sich bei $U_{N}$ und $V_{N}$ um endlichdimensionale Unterräume und damit bei dem linearen Operator $B_{N} \in \mathcal L(U_{N}, V_{N}')$ insbesondere um eine endlichdimensionale lineare Abbildung, ist die Injektivität hierfür bekanntlich sowohl hinreichend als auch notwendig.
    \end{Beweis}
\end{Satz}

Neben der Injektivität von $B_{N}$ reicht auch eine der folgenden, dazu äquivalenten Bedingungen.

\begin{Satz}
\label{satz:grb:gv:aequivalente_bedingungen_zu_bijektiv}
    Seien $U_{N} \subset U$ und $V_{N} \subset V$ endlichdimensionale Unterräume gleicher Dimension $N$.
    Dann sind die folgenden Aussagen äquivalent:
    \begin{thmenumerate}
        \item\label{punkt:grb:gv:aequivalente_bedingungen_zu_bijektiv_1} $B_{N}$ ist injektiv, es existiert also für jedes $0 \neq u \in U_{N}$ ein $v \in V_{N}$, so dass $b(u, v) \neq 0$ gilt.
        \item\label{punkt:grb:gv:aequivalente_bedingungen_zu_bijektiv_2} $B'_{N}$ ist injektiv, es existiert also für jedes $0 \neq v \in V_{N}$ ein $u \in U_{N}$, so dass $b(u, v) \neq 0$ gilt.
        \item\label{punkt:grb:gv:aequivalente_bedingungen_zu_bijektiv_3} Es gilt die inf-sup-Bedingung
            \begin{equation}
                \inf_{u \in U_{N}} \sup_{v \in V_{N}} \frac{b(u, v)}{\norm{u}_{U} \norm{v}_{V}} > 0.
            \end{equation}
        \item\label{punkt:grb:gv:aequivalente_bedingungen_zu_bijektiv_4} Es gilt die inf-sup-Bedingung
            \begin{equation}
                \inf_{v \in V_{N}} \sup_{u \in U_{N}} \frac{b(u, v)}{\norm{u}_{U} \norm{v}_{V}} > 0.
            \end{equation}
        \item\label{punkt:grb:gv:aequivalente_bedingungen_zu_bijektiv_5} Es gelten beide inf-sup-Bedingungen für ein $\beta_{N} > 0$, also
            \begin{equation}
                \inf_{u \in U_{N}} \sup_{v \in V_{N}} \frac{b(u, v)}{\norm{u}_{U} \norm{v}_{V}}
                = \inf_{v \in V_{N}} \sup_{u \in U_{N}} \frac{b(u, v)}{\norm{u}_{U} \norm{v}_{V}}
                = \beta_{N} > 0.
            \end{equation}
    \end{thmenumerate}

    \begin{Beweis}
        Siehe \cite[Proposition 3.1]{Nochetto:2009il}.
    \end{Beweis}
\end{Satz}

Zwar lassen sich die Bedingungen \ref{punkt:grb:gv:aequivalente_bedingungen_zu_bijektiv_1}--\ref{punkt:grb:gv:aequivalente_bedingungen_zu_bijektiv_4} im Allgemeinen einfacher nachweisen als \ref{punkt:grb:gv:aequivalente_bedingungen_zu_bijektiv_5}, allerdings spielt die inf-sup-Konstante $\beta_{N}$ eine wichtige Rolle und wird oftmals explizit benötigt.
Dies wird bei den folgenden Stabilitätsaussagen zur diskreten Lösung deutlich.

\begin{Korollar}
\label{kor:grb:gv:stabilitaet_der_diskreten_loesung}
    Sei Bedingung \ref{punkt:grb:gv:aequivalente_bedingungen_zu_bijektiv_5} von \cref{satz:grb:gv:aequivalente_bedingungen_zu_bijektiv} erfüllt, dann erfüllt die diskrete Lösung $u_{N} \in U_{N}$ von \cref{eq:grb:gv:diskretes_problem} die Abschätzung
    \begin{equation}
    \label{eq:grb:gv:stabilitaet_der_diskreten_loesung}
        \norm{u_{N}}_{U} \leq \frac{1}{\beta_{N}} \norm{f}_{V'}.
    \end{equation}

    \begin{Beweis}
        Folgt direkt aus dem \acl{bnb}, \cref{satz:gl:le:bnb_theorem}.
    \end{Beweis}
\end{Korollar}

Neben dieser Stabilitätsaussage können wir auch die Abweichung der diskreten Lösung $u_{N}$ von der \emph{Bestapproximation} der Lösung $u$ des tatsächlichen Variationsproblems in $U_{N}$ abschätzen.
Für die Definition der Bestapproximation greift man auf die als \emph{Galerkin-Orthogonalität} bekannte Eigenschaft zurück.
\mdo{Mehr dazu schreiben!}

\begin{Satz}[Irgendwas mit Bestapproximation]
\label{satz:grb:gv:bestapproximation_abschaetzung}
    Sei $u \in U$ die Lösung des Variationsproblems \textbf{??}, das diskrete Problem erfülle die diskrete inf-sup-Bedingung für ein $\beta_{N} > 0$ und sei weiter $u_{N} \in U_{N}$ die diskrete Lösung.
    Dann erfüllt der Fehler $u - u_{N}$ die Abschätzung
    \begin{equation}
    \label{eq:grb:gv:bestapproximation_abschaetzung}
        \norm{u - u_{N}}_{U} \leq \frac{\norm{B}}{\beta_{N}} \min_{w \in U_{N}} \norm{u - w}_{U}.
    \end{equation}

    \begin{Beweis}
        Siehe \cite[Theorem 3.2]{Nochetto:2009il}.
    \end{Beweis}
\end{Satz}

Anhand der letzten beiden Aussagen wird auch die Wichtigkeit der diskreten inf-sup-Konstante $\beta_{N}$ klar.
Betrachtet man beispielsweise eine Folge von Räumen $\Set{(U_{N}, V_{N})}_{N \geq 1}$, welche eine immer genauer werdende Approximation der Räume $U$ und $V$ durch endlichdimensionale Unterräume darstellen soll, dann lässt sich im Allgemeinen nicht ausschließen, dass $\beta_{N} \to 0$ für $N \to \infty$ konvergiert.
In diesem Fall bilden die Lösungen $\Set{u_{N}}_{N \geq 1}$ keine gleichmäßig beschränkte Folge und die Abschätzungen aus \cref{kor:grb:gv:stabilitaet_der_diskreten_loesung} und \cref{satz:grb:gv:bestapproximation_abschaetzung} werden immer schlechter.
Dies motiviert die folgende Definition.

\begin{Definition}[Stabile Diskretisierung]
\label{def:grb:gv:stabile_diskretisierung}
    Wir nennen eine Folge $\Set{(U_{N}, V_{N})}_{N \geq 1}$ von Unterräumen von $U$ und $V$ mit diskreten inf-sup-Konstanten $\Set{\beta_{N}}_{N \geq 1}$ genau dann \emph{stabil}, wenn eine Konstante $\beta_{\mathrm{LB}} > 0$ mit
    \begin{equation}
        \label{eq:grb:gv:stabile_diskretisierung_inf_sup_lower_bound}
        \inf_{N \geq 1} \beta_{N} \geq \beta_{\mathrm{LB}} > 0
    \end{equation}
    existiert.
\end{Definition}

\mfix{Stimmt das folgende überhaupt?}
Anders als bei der Betrachtung unendlichdimensionaler Variationsprobleme reicht es nach \cref{satz:grb:gv:aequivalente_bedingungen_zu_bijektiv}, eine der beiden inf-sup-Bedingungen
\begin{equation}
    \inf_{u \in U_{N}} \sup_{v \in V_{N}} \frac{b(u, v)}{\norm{u}_{U} \norm{v}_{V}}
    \geq \beta_{\mathrm{LB}}
    \qquad \text{oder} \qquad
     \inf_{v \in V_{N}} \sup_{u \in U_{N}} \frac{b(u, v)}{\norm{u}_{U} \norm{v}_{V}}
    \geq \beta_{\mathrm{LB}}
\end{equation}
nachzuweisen.

% subsection grundlagen (end)


\subsection{Numerische Umsetzung} % (fold)
\label{sub:grb:gv:numerische_umsetzung}

\mdo{Schreiben!}

% subsection numerische_umsetzung (end)


\section{Reduzierte-Basis-Methode} % (fold)
\label{sec:grb:rb:reduzierte_basis_methode}

\subsection{Grundlagen} % (fold)
\label{sub:grb:rb:grundlagen}

\begin{figure}[tb]
    \centering
    \includestandalone[width=0.6\textwidth]{tikz/rb}
    \caption[%
    Skizzenhafte Darstellung der Funktionsweise der Reduzierte-Basis-Methode.
    ]{
        Skizzenhafte Darstellung der Funktionsweise der Reduzierte-Basis-Methode.
        Die Reduzierte-Basis-Approximation $u_{N}(\mu)$ ergibt sich als Linearkombination der Finite-Elemente-Snapshots $u^{\mathcal N}(\mu_{i})$, welche mutmaßlich eine glatte parametrische Manigfaltigkeit bilden.
        }
    \label{fig:figure1}
\end{figure}

% subsection grundlagen (end)

\subsection{Sampling-Strategien} % (fold)
\label{sub:grb:rb:sampling_strategien}

% subsection sampling_strategien (end)

\subsection{Numerische Umsetzung} % (fold)
\label{sub:grb:rb:numerische_umsetzung}

% subsection numerische_umsetzung (end)

% section reduzierte_basis_methode (end)

% chapter reduzierte_basis_methode (end)
